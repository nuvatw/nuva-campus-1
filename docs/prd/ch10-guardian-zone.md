# Chapter 10: 守護者專區

[← 返回索引](./README.md) | [上一章](./ch09-ambassador-zone.md) | [下一章 →](./ch11-checkin-lunch.md)

---

## 10.1 功能描述

守護者是活動執行團隊的角色。進入守護者專區需要第一層密碼，進入特定活動需要第二層密碼。

## 10.2 雙層密碼機制

```
首頁 → 點擊「守護者」
    ↓
輸入第一層密碼（0001）
    ↓
進入守護者首頁（顯示 ongoing 活動列表）
    ↓
點擊特定活動
    ↓
輸入第二層密碼（活動專屬，如 WS02 是 0202）
    ↓
進入活動執行介面
```

## 10.3 守護者首頁

```
┌─────────────────────────────────────────────────────────────┐
│  [← 返回首頁]                                               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│                      守護者                                  │
│                                                             │
│                  活動執行團隊專區                            │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  進行中的活動                                                │
│  ───────────                                                │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  │  校園計劃 WS02                                      │   │
│  │  2026.02.15 (六) 09:00 - 17:00                     │   │
│  │  台北市立大學                                       │   │
│  │                                                     │   │
│  │  已報名: 45 人  |  需便當: 30 份                    │   │
│  │                                                     │   │
│  │                            [  進入執行  →]          │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 10.4 活動執行介面

```
┌─────────────────────────────────────────────────────────────┐
│  [← 返回]                              校園計劃 WS02         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────────────┐  ┌──────────────────────┐        │
│  │                      │  │                      │        │
│  │        報到          │  │       便當領取        │        │
│  │                      │  │                      │        │
│  │   ───────────────    │  │   ───────────────    │        │
│  │                      │  │                      │        │
│  │   已報到: 25/45      │  │   已領取: 18/30      │        │
│  │                      │  │                      │        │
│  └──────────────────────┘  └──────────────────────┘        │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  │  發送通知                                           │   │
│  │  ───────────                                        │   │
│  │                                                     │   │
│  │  尚未發送報到編號: 20 人                            │   │
│  │                                                     │   │
│  │  [  發送測試郵件  ]    [  發送全部郵件  ]           │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 10.5 路由結構

```
/guardian                      # 守護者首頁（第一層密碼）
/guardian/events/[id]          # 活動執行介面（第二層密碼）
/guardian/events/[id]/checkin  # 參與者報到
/guardian/events/[id]/lunch    # 便當領取
/guardian/events/[id]/notify   # 發送通知
```

## 10.6 活動資料來源

從現有的 workshops 資料中篩選 `status === 'ongoing'` 的活動。

```typescript
// 獲取 ongoing 活動
const { data: events } = await supabase
  .from('workshops')
  .select('*')
  .eq('status', 'ongoing');
```

## 10.7 第二層密碼查詢

```typescript
// 活動密碼 key 格式: event_{eventId}
const passwordKey = `event_${eventId}`;

const { data } = await supabase
  .from('access_passwords')
  .select('password')
  .eq('key', passwordKey)
  .single();
```

## 10.8 Chain of Thought - 實施步驟

```
1. 建立資料夾結構
   - mkdir /app/guardian
   - mkdir /app/guardian/events
   - mkdir /app/guardian/events/[id]

2. 建立 /app/guardian/layout.tsx
   - 加入 AuthGuard
   - 檢查 guardian 權限

3. 建立 /app/guardian/page.tsx（守護者首頁）
   - 獲取 ongoing 活動列表
   - 顯示活動卡片
   - 點擊進入需要第二層密碼

4. 建立 /app/guardian/events/[id]/layout.tsx
   - 第二層密碼驗證
   - 根據 eventId 查詢對應密碼

5. 建立 /app/guardian/events/[id]/page.tsx
   - 執行團隊首頁
   - 報到/便當統計卡片
   - 發送通知區塊

6. 建立報到、便當、通知子頁面
   - checkin/page.tsx
   - lunch/page.tsx
   - notify/page.tsx
```
